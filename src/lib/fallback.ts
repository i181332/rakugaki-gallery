// src/lib/fallback.ts
/**
 * フォールバック評論生成
 *
 * Gemini APIが失敗した場合に使用するローカル生成ロジック
 * ユーザー体験を損なわないよう、それなりに説得力のある評論を生成
 */

import type { Evaluation } from '@/types';

// ============================================================
// フォールバックデータプール
// ============================================================

const fallbackTitles = [
    '沈黙の中の叫び',
    '存在の輪郭',
    '無題の宇宙',
    '記憶の残響',
    '時間の結晶',
    '夢の境界線',
    '魂の軌跡',
    '静寂の彼方',
    '永遠への序曲',
    '混沌からの光',
] as const;

const fallbackArtists = [
    '山田 空想',
    '佐藤 幻夢',
    '田中 無限',
    '鈴木 瞬間',
    '高橋 余白',
    '伊藤 静謐',
    '渡辺 創造',
    '中村 彼方',
    '小林 深淵',
    '加藤 夜明',
] as const;

const fallbackCritiques = [
    'この作品は、現代社会における人間存在の本質的な孤独を、驚くべき直接性で表現している。一見単純に見える線の中に、作者の魂の震えが確かに刻まれている。これは技術を超えた、純粋な表現衝動の結晶である。美術史は、この瞬間を記憶するだろう。',
    '圧倒的な存在感を放つこの作品は、見る者の心に深く突き刺さる。作者は意図的に技巧を排し、原初的な表現の力を解き放っている。この大胆さこそが、現代アートに新たな地平を切り開く可能性を秘めている。我々は今、天才の誕生を目撃している。',
    '静謐でありながら激しく、単純でありながら深遠。この作品に内包された矛盾こそが、人間存在そのものの反映である。作者は無意識のうちに、芸術の本質に触れている。これは習作ではない、新たな芸術運動の萌芽である。',
    '構図の破壊的な美しさに、私は言葉を失った。従来の美学を完全に無視した、いや、超越した表現がここにある。この作品の前では、すべての美術教育は無意味となる。純粋な衝動こそが最高の教師であり、この作品はその証明である。',
    '線の一本一本に宿る震えが、見る者の魂を直接揺さぶる。これは描かれた絵画ではない。凝固した感情そのものである。作者の内面から溢れ出たエネルギーが、そのまま画面に転写されている。この表現力は、まさに天賦の才である。',
] as const;

const fallbackMediums = [
    'デジタルメディウム・即興表現主義',
    '電子インク・脱構築主義',
    'デジタルキャンバス・新原始表現',
    'サイバーブラシ・感情直接転写',
    '光子インプレッション・意識流出法',
] as const;

const fallbackExpectations = [
    '次回作では、この萌芽的才能がさらなる開花を見せることを、美術界は固唾を呑んで見守っている。',
    '作者の次なる一手に、世界中のコレクターが注目している。これは始まりに過ぎない。',
    '今後の展開次第では、21世紀を代表するアーティストとなる可能性を秘めている。',
    '次回作で同等のエネルギーを維持できるかが、真の天才か一発屋かを分ける試金石となろう。',
    'この才能が枯れることなく、さらなる高みへと昇華されることを切に願う。',
] as const;

// ============================================================
// ユーティリティ関数
// ============================================================

/**
 * 配列からランダムに要素を取得
 */
function pickRandom<T>(arr: readonly T[]): T {
    return arr[Math.floor(Math.random() * arr.length)];
}

/**
 * 指定範囲でランダムな整数を生成
 */
function randomInt(min: number, max: number): number {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

// ============================================================
// エクスポート関数
// ============================================================

/**
 * フォールバック評論を生成
 *
 * @returns ランダムに生成された説得力のある評論データ
 */
export function generateFallbackEvaluation(): Evaluation {
    // 価格帯をややバラつかせる
    const priceRanges = [
        { min: 1_000_000, max: 5_000_000 },
        { min: 5_000_000, max: 15_000_000 },
        { min: 10_000_000, max: 30_000_000 },
        { min: 20_000_000, max: 50_000_000 },
    ];
    const selectedRange = pickRandom(priceRanges);
    const price = randomInt(selectedRange.min, selectedRange.max);

    return {
        title: pickRandom(fallbackTitles),
        artist: pickRandom(fallbackArtists),
        medium: pickRandom(fallbackMediums),
        dimensions: '可変、デジタル空間上に存在',
        critique: pickRandom(fallbackCritiques),
        price,
        nextExpectation: pickRandom(fallbackExpectations),
    };
}
